name: "ArgoCD Actions"
description: "Operate your ArgoCD applications from GitHub"
author: "omegion"
inputs:
  address:
    description: "ArgoCD server address"
    required: true
  token:
    description: "ArgoCD token"
    required: true
  action:
    description: "Action name"
    required: true
  appName:
    description: "Application name to sync"
    required: true

runs:
  using: "composite"
  steps:
    - name: Generate 0 or 1
      id: generate_number
      run: echo "::set-output name=random_number::$(($RANDOM % 2))"
      shell: sh

    - uses: docker://ghcr.io/omegion/argocd-actions:${{ steps.generate_number.outputs.random_number }}

    - name: Get the version
      shell: sh
      run: |
        ls /bin

#runs:
#  using: "docker"
#  image: "docker://ghcr.io/omegion/argocd-actions:v0.1.0-12-gfbee836"
#  args:
#    - argocd-actions
#    - ${{ inputs.action }}
#    - "--application=${{ inputs.appName }}"
#    - "--token=${{ inputs.token }}"
#    - "--address=${{ inputs.address }}"
#    - "--logLevel=debug"
