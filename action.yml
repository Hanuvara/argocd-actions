name: "ArgoCD Actions"
description: "Operate your ArgoCD applications from GitHub"
author: "omegion"
inputs:
  address:
    description: "ArgoCD server address"
    required: true
  token:
    description: "ArgoCD token"
    required: true
  action:
    description: "Action name"
    required: true
  appName:
    description: "Application name to sync"
    required: true

#runs:
#  using: "composite"
#  steps:
#    - name: Get the version
#      shell: sh
#      run: |
#        go mod init

runs:
  using: "composite"
  steps:
    # Reference a specific commit
    - name: Get the version
      run: |
        VERSION=$(echo $GITHUB_REF | cut -d / -f 3)
        echo "VERSION=$VERSION" >> $GITHUB_ENV
      shell: sh

    - name: test
      run: |
        env
        docker run --rm -i ghcr.io/omegion/argocd-actions:${{ github.ref_name }} ls
      shell: sh

#runs:
#  using: 'docker'
#  image: "docker://ghcr.io/omegion/argocd-actions:${{ toJSON(inputs) }}"
#  args:
#    - argocd-actions


#  using: "docker"
#  image: "docker://ghcr.io/omegion/argocd-actions:v0.1.0-12-gfbee836"
#  args:
#    - argocd-actions
#    - ${{ inputs.action }}
#    - "--application=${{ inputs.appName }}"
#    - "--token=${{ inputs.token }}"
#    - "--address=${{ inputs.address }}"
#    - "--logLevel=debug"
